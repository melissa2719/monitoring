# needed packages
# to read the copernicus data I have to install a package and to use "" in order to let R know that the data is external to the program 
install.packages("ncdf4") 
#function library to recall the package
library(ncdf4)

# ggplot2 is used to create graphics 
install.packages("ggplot2")
library(ggplot2)

#RStoolbox is used for remote sensing image processing 
install.packages("RStoolbox")
library(RStoolbox)

# install raster package because data are saved in pixels. In the spatial world, each pixel represents an area on the Earth's surface.
install.packages("raster")
library(raster)


# set the working directory; since I am a windows user i will use setwd("c:/name of the folder which contain the data/")
setwd("c:/lab/")

# for this project I want to study NDVI, fires disturbance and land surface temperature. See if and how those variables have changed over time due to the Amazonian fire season
# I choose to plot also the fires disturbance to see the differences in occurrence from this period and others in Amazonian forest.

#I want to analyse the difference in NDVI during the last years in Amazonian forest
# The Normalized Difference Vegetation Index (NDVI) is an indicator of the greenness of the biomes
# I am going to check NDVI for 2015; 2019; 2020.  I'm using "" because data are external to R and I need to import them
# NDVI is used to observe if the vegetation is alive
# ndvi after Amazonian fire season in 2015 (Dec 2015)
ndvi2015<-raster("c_gls_NDVI300_201512210000_GLOBE_PROBAV_V1.0.1.nc")
#ndvi after Amazonian fire season in 2019 (Dec 2019)
ndvi2019<-raster("c_gls_NDVI300_201912210000_GLOBE_PROBAV_V1.0.1.nc")
#ndvi after Amazonian fire season in 2020 (Dec 2020)
ndvi2020<-raster("c_gls_NDVI300_202012210000_GLOBE_PROBAV_V1.0.1.nc")

# to see all the data
Ncl <- colorRampPalette(c('red','gold','darkgoldenrod3',"cyan","cyan4","chartreuse1","darkgreen"))(100)
plot(ndvi2015, col=Ncl)

 
# I'm going to plot just the cropped image on South America since the data are heavy, morover I want to focus on Amazonian forest.
#I choose to crop all the southern continent in order to see better the consequences.
ext<- c(-90,-25,-75,20) #xmin xmax, ymin e ymax
# let's crop the ndvi for 2015,2019 and 2020
ndvi2015 <- crop(ndvi2015, ext)
ndvi2019 <- crop(ndvi2019, ext)
ndvi2020 <- crop(ndvi2020, ext)

Ncl <- colorRampPalette(c('red','gold','darkgoldenrod3',"cyan","cyan4","chartreuse1","darkgreen"))(100)  # to define the color palette 
#100 is referred to the number of colors that I'm using, it is possible to put any number
plot(ndvi2015, col=Ncl, main="NDVI 2015") #function main it's used to name the map

# Now I'm going to export the map in png
png("NDVI 2015.png")
Ncl <- colorRampPalette(c('red','gold','darkgoldenrod3',"cyan","cyan4","chartreuse1","darkgreen"))(100)
plot(ndvi2015, col=Ncl,main="NDVI2015") 
dev.off()


